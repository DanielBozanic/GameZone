getSoldVideoGamesByPlatform
	
   | productDatabase queryResult dictionaryResult jsonResult|
	
   productDatabase := self getDatabase: 'product-db'.

   queryResult := productDatabase basicExecuteSQLString: 
		'SELECT video_games.platform, SUM(product_purchase_details.product_quantity) 
		 FROM product_purchases 
		 JOIN product_purchase_details ON product_purchases.id = product_purchase_details.product_purchase_id 
		 JOIN video_games ON product_purchase_details.product_id = video_games.product_id 
		 WHERE product_purchases.is_paid_for = true 
		 GROUP BY video_games.platform'.
		
   dictionaryResult := Dictionary new.
   queryResult do: [ :each | dictionaryResult at: (each at: 1) put: (each at: 2) ].
	
   jsonResult := NeoJSONWriter toString: dictionaryResult.
   ^jsonResult